<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="detail-title">Details</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
     
    <link rel="stylesheet" href="detail-style.css"> 
</head>
<body>
    <div class="page-container">

        <header class="top-bar">
            <a href="map.html" class="back-link" onclick="history.back(); return false;">
                 <i class="fas fa-arrow-left header-icon"></i>
            </a>
             Detail
        </header>

        <main class="detail-wrapper">
            
            <section class="media-column">
                <div class="image-gallery">
                    <div class="main-image">
                        <img id="location-image" src="" alt="Location Image" class="location-image-display">
                                             <i class="fa-solid fa-image placeholder-icon" id="placeholder-icon"></i>
                    </div>
                </div>
            </section>

            <section class="info-column">
     
                <div class="title-block">
                    <h1 class="item-name" id="location-name">...</h1>
                    <span class="location-pin-icon"><i class="fa-solid fa-location-dot"></i></span>
                    <!--<span class="bookmark-icon"><i class="fa-regular fa-bookmark"></i></span>-->
                </div>

                <hr class="info-separator">

                <!--<div class="density-status">
                    <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</strong></p>
                    <div class="density-level-box" id="density-status-box">...</div>
                </div>-->

                <div class="description-block">
                    <h2>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</h2>
                    <div class="schedule-detail">
                        <p class="schedule-item">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå - ‡∏®‡∏∏‡∏Å‡∏£‡πå : <span class="time-slot" id="working-hours-weekday">...</span></p>
                        <p class="schedule-item">‡πÄ‡∏™‡∏≤‡∏£‡πå - ‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå : <span class="time-slot closed" id="working-hours-weekend">...</span></p>
                    </div>
  
                    <h2 class="full-description-title">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h2>
                    <p class="full-description-text" id="full-description-text">...</p>
                </div>
     
                <button class="cta-button">‡∏î‡∏π‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏ô‡∏≥‡∏ó‡∏≤‡∏á</button>

            </section>
        </main>
    </div>

    <script src="map-script.js"></script>
    <script>
         // Logic ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å URL ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
         document.addEventListener('DOMContentLoaded', function() {
            const params = new URLSearchParams(window.location.search);
            const shortName = params.get('shortName');

                if (shortName) {
                // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Mock Data ‡πÉ‡∏ô map-script.js
                 const locationDetails = MOCK_LOCATIONS_DATA.find(loc => 
                     loc.shortName.toLowerCase() === shortName.toLowerCase()
                );

                if (locationDetails) {
                    // 1. Logic ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                    const locationImage = document.getElementById('location-image');
                    const placeholderIcon = document.getElementById('placeholder-icon');
                    
                    if (locationDetails.imagePath) {
                        locationImage.src = locationDetails.imagePath;
                        locationImage.style.display = 'block'; // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                        placeholderIcon.style.display = 'none'; // ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô
                    } else {
                        locationImage.style.display = 'none';
                        placeholderIcon.style.display = 'block'; // ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ
                    }

                    // 2. Logic ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏∑‡πà‡∏ô‡πÜ
                    document.getElementById('detail-title').textContent = `${locationDetails.name} Details`;
                    document.getElementById('location-name').textContent = `${locationDetails.name} (${locationDetails.shortName})`;
     
                    document.getElementById('working-hours-weekday').textContent = locationDetails.workingHoursWeekday || 'N/A';
                    document.getElementById('working-hours-weekend').textContent = locationDetails.workingHoursWeekend || 'N/A';
 
                    /*const densityBox = document.getElementById('density-status-box');
                    densityBox.textContent = `‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô: ${locationDetails.densityStatus}`;
                    densityBox.className = 'density-level-box ' + (
                        locationDetails.densityStatus === '‡∏ß‡πà‡∏≤‡∏á' ? 'low' : 
                        locationDetails.densityStatus === '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á' ? 'medium' : 'high'
                    );*/

                    document.getElementById('full-description-text').textContent = locationDetails.detailDescription || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°';
                } else {
                    document.getElementById('location-name').textContent = `‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ${shortName}`;
                    }
                } else {
                    document.getElementById('location-name').textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà';
                }
        });
    </script>
	
	<script type="module">
	  import { protectPage } from "/authGuard.js";

	  // üß© ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ admin
	  protectPage(true);

	  window.addEventListener("beforeunload", (event) => {
	    const nextUrl = document.activeElement?.href || "";
	    
	    // ‡∏ñ‡πâ‡∏≤ URL ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà /admin/... ‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏á (‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏¥‡∏î‡πÅ‡∏ó‡πá‡∏ö)
	    if (!nextUrl.includes("/admin/")) {
	      console.log("üßπ Leaving admin area ‚Üí clearing auth info...");
	      localStorage.removeItem("role");
	      localStorage.removeItem("tu_token");
	      localStorage.removeItem("student_info");
	    } else {
	      console.log("üîí Still inside admin area, keep session.");
	    }
	  });
	</script>

    
</body>
</html>